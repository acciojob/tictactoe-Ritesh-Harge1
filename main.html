<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tic Tac Toe</title>
  <style>
    body { font-family: Arial, Helvetica, sans-serif; display:flex; justify-content:center; }
    .container { width:420px; margin:24px; text-align:center; }
    #board { display:none; }
    .grid { display:grid; grid-template-columns: repeat(3, 120px); grid-gap:8px; justify-content:center; }
    .cell { height:120px; display:flex; align-items:center; justify-content:center; font-size:48px; background:#f7f7f7; border:2px solid #333; cursor:pointer; user-select:none; }
    input[type=text] { width:80%; padding:8px; font-size:16px; }
    button { padding:8px 16px; font-size:16px; }
    .message { margin-top:16px; font-weight:600; }
    .hidden { display:none !important; }
  </style>
</head>
<body>
  <div class="container">
    <!-- Player input screen -->
    <div id="player-input">
      <h1>Enter Player Names</h1>
      <input type="text" id="player-1" placeholder="Player 1 Name" />
      <br><br>
      <input type="text" id="player-2" placeholder="Player 2 Name" />
      <br><br>
      <button id="submit">Submit</button>
    </div>

    <!-- Game board screen -->
    <div id="board">
      <h1>Tic Tac Toe</h1>
      <div class="message"></div>
      <div class="grid">
        <div class="cell" id="1"></div>
        <div class="cell" id="2"></div>
        <div class="cell" id="3"></div>
        <div class="cell" id="4"></div>
        <div class="cell" id="5"></div>
        <div class="cell" id="6"></div>
        <div class="cell" id="7"></div>
        <div class="cell" id="8"></div>
        <div class="cell" id="9"></div>
      </div>
    </div>
  </div>

  <script>
    (function () {
      let player1 = '';
      let player2 = '';
      let currentPlayer = '';
      let currentSymbol = 'x'; // use lowercase 'x' and 'o' to match test expectations
      let gameActive = true;

      const winningCombinations = [
        [1,2,3], [4,5,6], [7,8,9],
        [1,4,7], [2,5,8], [3,6,9],
        [1,5,9], [3,5,7]
      ];

      const submitBtn = document.getElementById('submit');
      const messageDiv = document.querySelector('.message');
      const boardDiv = document.getElementById('board');
      const playerInputDiv = document.getElementById('player-input');

      submitBtn.addEventListener('click', function () {
        player1 = (document.getElementById('player-1').value || '').trim();
        player2 = (document.getElementById('player-2').value || '').trim();

        if (!player1 || !player2) {
          alert('Please enter names for both players!');
          return;
        }

        // prepare board
        playerInputDiv.classList.add('hidden');
        boardDiv.style.display = 'block';
        currentPlayer = player1;
        currentSymbol = 'x';
        gameActive = true;

        // clear cells
        document.querySelectorAll('.cell').forEach(c => c.textContent = '');

        // initial message: name, you're up
        messageDiv.textContent = `${currentPlayer}, you're up`;
      });

      // cell click handling
      document.querySelectorAll('.cell').forEach(cell => {
        cell.addEventListener('click', function () {
          if (!gameActive) return;
          if (this.textContent !== '') return; // already filled

          this.textContent = currentSymbol;

          // check for win
          if (checkWin()) {
            // winner message must be exactly: "{username} congratulations you won!"
            messageDiv.textContent = `${currentPlayer} congratulations you won!`;
            gameActive = false;
            return;
          }

          // switch player
          if (currentPlayer === player1) {
            currentPlayer = player2;
            currentSymbol = 'o';
          } else {
            currentPlayer = player1;
            currentSymbol = 'x';
          }

          messageDiv.textContent = `${currentPlayer}, you're up`;
        });
      });

      function checkWin() {
        return winningCombinations.some(combination => {
          return combination.every(idx => {
            const cell = document.getElementById(String(idx));
            return cell && cell.textContent === currentSymbol;
          });
        });
      }

      // expose for tests if needed
      if (typeof window !== 'undefined') {
        window._ttt = { reset: () => {
          playerInputDiv.classList.remove('hidden');
          boardDiv.style.display = 'none';
          messageDiv.textContent = '';
          document.getElementById('player-1').value = '';
          document.getElementById('player-2').value = '';
          document.querySelectorAll('.cell').forEach(c => c.textContent = '');
          player1 = player2 = currentPlayer = '';
          currentSymbol = 'x';
          gameActive = true;
        }};
      }
    })();
  </script>
</body>
</html>